SELECT a.PRODUCT_CODE, SUM(SALES_AMOUNT * PRICE) AS "SALES"
FROM PRODUCT a
JOIN OFFLINE_SALE b
ON a.PRODUCT_ID = b.PRODUCT_ID
GROUP BY a.PRODUCT_CODE
ORDER BY "SALES" DESC, PRODUCT_CODE
;